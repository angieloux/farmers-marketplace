
    <h3> <%= @listing.name %></h3>
    <h5>Category: <%= @listing.category.name %></h5>
    <h5>Price: <%= @listing.price %></h5>
    <% if @listing.image.attached? %>
        <%= image_tag url_for(@listing.image), width: '250px' %>
    <% end %>
    <p><%= @listing.description %></p>

<!-- only let the user who created the listing edit and delete it -->
<% if user_signed_in? && current_user.id == @listing.user.id %>
    <%= link_to "Edit", edit_listing_path(@listing) %>
    <%= link_to "Delete", listing_path(@listing), method: :delete, data: {confirm: "Are you sure?"} %>
<% end %>

<button data-stripe="payment">Buy <%= number_to_currency(@listing.price) %></button>

<%= link_to 'Back', listings_path %>
<script src="https://js.stripe.com/v3/"></script>

<script>
    document.querySelector("[data-stripe='payment']").addeventListener('click', () => {
        const stripe = Stripe("<%= Rails.application.credentials.dig(:stripe, :public_key) %>");
        stripe.redirectToCheckout({
            sessionId: "<%= @session_id %>"
        });

});
</script>

